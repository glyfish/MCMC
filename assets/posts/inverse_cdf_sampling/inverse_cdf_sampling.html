
<p>
 
<p>
Inverse <a href="https://en.wikipedia.org/wiki/Cumulative_distribution_function">CDF</a> sampling is a method for obtaining samples from both discrete and continuous probability distributions that requires the CDF to be invertable. The method proposes a CDF value from a Uniform random variable on [0, 1] that is then used as input into the inverted CDF to generate a sample with the desired discrete or continuous distribution. Here examples for both cases are discussed. For the continuous case a proof is given that demonstrates the samples produced have the expected distribution.
<p>
  <h2>Sampling Discrete Distributions</h2>  
<p>
A discrete probability distribution consisting of a finite set of $latex {N}&fg=000000$ probability values is defined by,
<p>
<p align=center>$latex \displaystyle \{p_1, p_2,\ldots,p_N\}&fg=000000$</p>

<p>
with $latex {\sum_{i=1}^N{p_i} = 1.}&fg=000000$
<p>
The CDF specifies the probability that $latex {i \leq n}&fg=000000$ and is given by, <a name="eqdiscrete_cdf"><p align=center>$latex \displaystyle   P(n)=\sum_{i=1}^n{p_i}, \ \ \ \ \ (1)&fg=000000$</p>
</a> where $latex {P(N)=1.}&fg=000000$
<p>
For a given CDF propsal, $latex {P^*}&fg=000000$, equation (<a href="#eqdiscrete_cdf">1</a>) can always be inverted by evaluating it for each $latex {n}&fg=000000$ and searching for the value of $latex {n}&fg=000000$ that satisfies, $latex {P(n) \geq P^*.}&fg=000000$ It can be seen that the generated samples will have distribution $latex {\{p_n\}}&fg=000000$ since the intervals $latex {P(n-1) - P(n) = p_n}&fg=000000$ are Uniformly sampled.
<p>
Consider the distribution,
<p>
<a name="eqdiscrete"><p align=center>$latex \displaystyle   \left \{\frac{1}{12}, \frac{1}{12}, \frac{1}{6}, \frac{1}{6}, \frac{1}{12}, \frac{5}{12} \right\} \ \ \ \ \ (2)&fg=000000$</p>
</a>
<p>
It is shown in the following plot with its CDF.
<p>
 <p align=center><img width = 600 src="https://gly.fish/wp-content/uploads/posts/inverse-cdf-sampling/discrete_cdf.png"></p>  
<p>
A sampler using the Inverse CDF method can be implemented in Python in a few lines of code,
<p>
  <pre class="lang:python"> import numpy
<p>
n = 10000 df = numpy.array([1/12, 1/12, 1/6, 1/6, 1/12, 5/12]) cdf = numpy.cumsum(df)
<p>
cdf_star = numpy.random.rand(n) samples = [numpy.flatnonzero(cdf >= cdf_star[i])[0] for i in range(n)] </pre> 
<p>

<p>
The figure below favoably compares samples generated by the Inverse CDF sampler and distribution (<a href="#eqdiscrete">2</a>),  <p align=center><img width = 600 src="https://gly.fish/wp-content/uploads/posts/inverse-cdf-sampling/discrete_sampled_distribution.png"></p>  
<p>
  It is also possible to directly sample $latex {\{p_n\}}&fg=000000$ using the <code>multinomial</code> sampler from <code>numpy</code>,
<p>
<pre class="lang:python"> import numpy
<p>
n = 10000 df = numpy.array([1/12, 1/12, 1/6, 1/6, 1/12, 5/12]) samples = numpy.random.multinomial(n, df, size=1)/n </pre> 
<p>

<p>
  <h2>Sampling Continuous Distributions</h2>  
<p>
